-- Data: init commit

--{-# OPTIONS --show-implicit #-}
--{-# OPTIONS --rewriting #-}
module Oscar.Data0 where

data âŸ¦âŸ§ : Set where
  âˆ… : âŸ¦âŸ§
  ! : âŸ¦âŸ§ â†’ âŸ¦âŸ§

data âŸ¦_âŸ§ {a} (A : Set a) : Set a where
  âˆ… : âŸ¦ A âŸ§
  _âˆ·_ : A â†’ âŸ¦ A âŸ§ â†’ âŸ¦ A âŸ§

data âŸ¦âŸ§[_] : âŸ¦âŸ§ â†’ Set where
  âˆ… : âˆ€ {n} â†’ âŸ¦âŸ§[ ! n ]
  ! : âˆ€ {n} â†’ âŸ¦âŸ§[ n ] â†’ âŸ¦âŸ§[ ! n ]

data âŸ¦_âŸ§[_] {a} (A : âŸ¦âŸ§ â†’ Set a) : âŸ¦âŸ§ â†’ Set a where
  âˆ… : âˆ€ {n} â†’ âŸ¦ A âŸ§[ ! n ]
  _âˆ·_ : âˆ€ {n} â†’ A n â†’ âŸ¦ A âŸ§[ n ] â†’ âŸ¦ A âŸ§[ ! n ]

data âŸ¦âŸ§[_â‰¤â†“_] (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set where
  âˆ… : âŸ¦âŸ§[ m â‰¤â†“ m ]
  ! : âˆ€ {n} â†’ âŸ¦âŸ§[ m â‰¤â†“ n ] â†’ âŸ¦âŸ§[ m â‰¤â†“ ! n ]

data âŸ¦_âŸ§[_â‰¤â†“_] {a} (A : âŸ¦âŸ§ â†’ Set a) (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set a where
  âˆ… : âŸ¦ A âŸ§[ m â‰¤â†“ m ]
  _âˆ·_ : âˆ€ {n} â†’ A n â†’ âŸ¦ A âŸ§[ m â‰¤â†“ n ] â†’ âŸ¦ A âŸ§[ m â‰¤â†“ ! n ]

data âŸ¦âŸ§[_â†‘â‰¤_] (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set where
  âˆ… : âŸ¦âŸ§[ m â†‘â‰¤ m ]
  ! : âˆ€ {n} â†’ âŸ¦âŸ§[ ! m â†‘â‰¤ n ] â†’ âŸ¦âŸ§[ m â†‘â‰¤ n ]

data âŸ¦_âŸ§[_â†‘â‰¤_] {a} (A : âŸ¦âŸ§ â†’ Set a) (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set a where
  âˆ… : âŸ¦ A âŸ§[ m â†‘â‰¤ m ]
  _âˆ·_ : âˆ€ {n} â†’ A m â†’ âŸ¦ A âŸ§[ ! m â†‘â‰¤ n ] â†’ âŸ¦ A âŸ§[ m â†‘â‰¤ n ]

data âŸ¦âŸ§[_â†“â‰¤â†“_] : âŸ¦âŸ§ â†’ âŸ¦âŸ§ â†’ Set where
  âˆ… : âˆ€ {n} â†’ âŸ¦âŸ§[ âˆ… â†“â‰¤â†“ n ]
  ! : âˆ€ {m n} â†’ âŸ¦âŸ§[ m â†“â‰¤â†“ n ] â†’ âŸ¦âŸ§[ ! m â†“â‰¤â†“ ! n ]

data âŸ¦_âŸ§[_â†“â‰¤â†“_] {a} (A : âŸ¦âŸ§ â†’ âŸ¦âŸ§ â†’ Set a) : âŸ¦âŸ§ â†’ âŸ¦âŸ§ â†’ Set a where
  âˆ… : âˆ€ {n} â†’ âŸ¦ A âŸ§[ âˆ… â†“â‰¤â†“ n ]
  ! : âˆ€ {m n} â†’ A m n â†’ âŸ¦ A âŸ§[ m â†“â‰¤â†“ n ] â†’ âŸ¦ A âŸ§[ ! m â†“â‰¤â†“ ! n ]



-- open import Oscar.Data.Unit
-- open import Oscar.Level
-- open import Data.Empty

-- ğ•‹ : âˆ€ {a} {A : Set a} â†’ A â†’ Set
-- ğ•‹ = Î» _ â†’ âŠ¤

-- postulate
--   â„“ : Level
--   Term : Set â„“



-- -- module _ where -- second constructor is recursive

-- --   -- Nat
-- --   data âŸ¦âŸ§ : Set where
-- --     âˆ… : âŸ¦âŸ§
-- --     ! : âŸ¦âŸ§ â†’ âŸ¦âŸ§

-- --   -- List
-- --   data âŸ¦_âŸ§ {a} (A : Set a) : Set a where
-- --     âˆ… : âŸ¦ A âŸ§
-- --     _âˆ·_ : A â†’ âŸ¦ A âŸ§ â†’ âŸ¦ A âŸ§

-- --   -- â‹†â‹† m, size: m
-- --   -- [ 0 ] = nothing
-- --   -- [ 1 ] = âˆ…0
-- --   -- [ 4 ] = âˆ…3 or !2âˆ…3 or !1!2âˆ…3 or !0!1!2âˆ…3
-- --   data âŸ¦âŸ§[_] : âŸ¦âŸ§ â†’ Set where
-- --     âˆ… : âˆ€ {n} â†’ âŸ¦âŸ§[ ! n ]
-- --     ! : âˆ€ {n} â†’ âŸ¦âŸ§[ n ] â†’ âŸ¦âŸ§[ ! n ]

-- --   data âŸ¦_âŸ§[_] {a} (A : âŸ¦âŸ§ â†’ Set a) : âŸ¦âŸ§ â†’ Set a where
-- --     âˆ… : âˆ€ {n} â†’ âŸ¦ A âŸ§[ ! n ]
-- --     _âˆ·_ : âˆ€ {n} â†’ A n â†’ âŸ¦ A âŸ§[ n ] â†’ âŸ¦ A âŸ§[ ! n ]

-- --   -- 0 : âˆ… (only)
-- --   -- 1 : âˆ… or ! âˆ…
-- --   -- 2 : âˆ… or ! âˆ…
-- --   -- 5 : âˆ… or !
-- --   -- size: m + 1
-- --   -- â‹†â‹†'' 0 = âˆ…0
-- --   -- â‹†â‹†'' 4 = âˆ…(m=4) or !3âˆ…4 or !2!3âˆ…4 or !1!2!3âˆ…4 or !0!1!2!3âˆ…4
-- --   data â‹†â‹†'' (m : âŸ¦âŸ§) : Set where
-- --     âˆ… : â‹†â‹†'' m
-- --     ! : â‹†â‹†'' (! m) â†’ â‹†â‹†'' m

-- --   -- â‹†â‹†'' âŠ‚ â‹†â‹†

-- --   -- m â‰¤ n == n - 1 â‹± m
-- --   -- m â†™ n
-- --   -- size = n - m
-- --   -- AList
-- --   -- 4â‰¤â†“2 = nothing
-- --   -- 2â‰¤â†“4 = !23!22âˆ…22
-- --   data âŸ¦âŸ§[_â‰¤â†“_] (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set where
-- --     âˆ… : âŸ¦âŸ§[ m â‰¤â†“ m ]
-- --     ! : âˆ€ {n} â†’ âŸ¦âŸ§[ m â‰¤â†“ n ] â†’ âŸ¦âŸ§[ m â‰¤â†“ ! n ]
-- --     -- A n

-- --   ï¼ˆ_â‹±_ï¼½ : âŸ¦âŸ§ â†’ âŸ¦âŸ§ â†’ Set
-- --   ï¼ˆ n â‹± m ï¼½ = âŸ¦âŸ§[ m â‰¤â†“ n ]

-- --   data âŸ¦_âŸ§[_â‰¤â†“_] {a} (A : âŸ¦âŸ§ â†’ Set a) (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set where
-- --     âˆ… : âŸ¦ A âŸ§[ m â‰¤â†“ m ]
-- --     ! : âˆ€ {n} â†’ A n â†’ âŸ¦ A âŸ§[ m â‰¤â†“ n ] â†’ âŸ¦âŸ§[ m â‰¤â†“ ! n ]

-- --   -- m â‰¤ n = m â‹° n - 1
-- --   -- m â†— n
-- --   -- size = n - m (+1?)
-- --   -- 2â†‘â‰¤4 = !24!34âˆ…44
-- --   data _â†‘â‰¤_ (m : âŸ¦âŸ§) : âŸ¦âŸ§ â†’ Set where
-- --     âˆ… : m â†‘â‰¤ m
-- --     ! : âˆ€ {n} â†’ ! m â†‘â‰¤ n â†’ m â†‘â‰¤ n
-- --     -- A m

-- --   ï¼»_â‹°_ï¼‰ : âŸ¦âŸ§ â†’ âŸ¦âŸ§ â†’ Set
-- --   ï¼» m â‹° n ï¼‰ = m â†‘â‰¤ n

-- --   -- m â‰¤ n == n - 1 â‹± n - m && m - 1 â‹± 0
-- --   -- size = m (+1?)
-- --   -- Inj
-- --   -- 2â†“â‰¤â†“4 = !13!02âˆ…02
-- --   data _â†“â‰¤â†“_ : âŸ¦âŸ§ â†’ âŸ¦âŸ§ â†’ Set where
-- --     âˆ… : âˆ€ {n} â†’ âˆ… â†“â‰¤â†“ n
-- --     ! : âˆ€ {m n} â†’ m â†“â‰¤â†“ n â†’ ! m â†“â‰¤â†“ ! n -- A m n

-- --   -- Fin
-- --   -- P 0 = âˆ…0 or !0âˆ…1 or !0!1âˆ…2 or ...
-- --   -- P 3 = âˆ…3 or !3âˆ…4 or !3!4âˆ…5 or ... (infinite)
-- --   data P (n : â‹†) : Set where
-- --     âˆ… : P n
-- --     ! : P (! n) â†’ P n

-- --   {-
-- --     3 <= 5 = ! (4 <= 5) = ! ! (5 <= 5) = ! ! âˆ…
-- --     3â‰¤5 witnesses
-- --     n=3,m=5
-- --       4   5
-- --   -}
-- --   -- m â‰¤ n == m ... n - 1 (this is the same as the two-indexed version)
-- --   data _â‰¤_ (n : â‹†) : â‹† â†’ Set where
-- --     âˆ… : n â‰¤ n
-- --     ! : âˆ€ {m} â†’ ! n â‰¤ m â†’ n â‰¤ m
-- --   -- or
-- --   -- m â‰¤ n == n - 1 ... m

-- --   three : â‹†
-- --   three = ! (! (! âˆ…))

-- --   five : â‹†
-- --   five = ! (! three)

-- --   foo : three â‰¤ five
-- --   foo = ! {n = {!!}} (! {n = {!!}} âˆ…)


-- -- --   {-
-- -- --     3 <= 5 = 3 <= ! 4 = ! (3 <= 4) = ! (! (3 <= 3)) = ! ! âˆ…
-- -- --     3 â‰¤ 5 witnesses
-- -- --     n=3,m=4
-- -- --     n=3,m=3
-- -- --
-- -- --   -}

-- -- --   data _â‰¤_ (n : â‹†) : â‹† â†’ Set where
-- -- --     âˆ… : n â‰¤ n
-- -- --     ! : âˆ€ {m} â†’ n â‰¤ m â†’ n â‰¤ ! m -- A m

-- -- --   {-
-- -- --     3 <= 5
-- -- --     m=2,n=4
-- -- --     m=1,n=3
-- -- --     m=0,n=2
-- -- --   -}
-- -- --   data _â‰¤_ : â‹† â†’ â‹† â†’ Set where
-- -- --     âˆ… : âˆ€ {n} â†’ âˆ… â‰¤ n
-- -- --     ! : âˆ€ {m n} â†’ m â‰¤ n â†’ ! m â‰¤ ! n


-- -- -- --   data # (n : â‹†) : Set where
-- -- -- --     âˆ… : # n
-- -- -- --     ! : # (

-- -- -- --   data # : â‹† â†’ Set where
-- -- -- --     âˆ… : # n
-- -- -- --     ! : â‹†


-- -- -- --   data â‹†[_] {a} (A : Set a) : Set a where
-- -- -- --     âˆ… : â‹†[ A ]
-- -- -- --     _âˆ·_ : A â†’ â‹†[ A ] â†’ â‹†[ A ]

-- -- -- --   data _â‰¥_ (n : â‹†) : â‹† â†’ Set where
-- -- -- --     âˆ… : n â‰¥ n
-- -- -- --     ! : âˆ€ {m} â†’ n â‰¥ Â¹âº m â†’ n â‰¥ m

-- -- -- -- {-
-- -- -- --   data _â‰¤_ (n : â‹†) : â‹† â†’ Set where
-- -- -- --     âˆ… : n â‰¤ n
-- -- -- --     ! : âˆ€ {m} â†’ n â‰¤ m â†’ n â‰¤ Â¹âº m
-- -- -- -- -}
-- -- -- --   data _â‰¥_ : â‹† â†’ â‹† â†’ Set where
-- -- -- --     âˆ… : âˆ€ {n} â†’ n â‰¥ âˆ…
-- -- -- --     ! : âˆ€ {m n} â†’ n â‰¥ m â†’ Â¹âº m â‰¤ Â¹âº n

-- -- -- --   _â‰±_ : â‹† â†’ â‹† â†’ Set
-- -- -- --   n â‰± m = n â‰¥ m â†’ âŠ¥

-- -- -- --   Îµ : âˆ€ {m} â†’ m â‰¥ m
-- -- -- --   Îµ = â‰¥âˆ…

-- -- -- --   Â¹âºâ‰¥ : âˆ€ {n m} â†’ n â‰¥ m â†’ Â¹âº n â‰¥ m
-- -- -- --   Â¹âºâ‰¥ â‰¥âˆ… = â‰¥â»Â¹ â‰¥âˆ…
-- -- -- --   Â¹âºâ‰¥ (â‰¥â»Â¹ nâ‰¥m) = â‰¥â»Â¹ (Â¹âºâ‰¥ nâ‰¥m)

-- -- -- --   âˆ…â‰±Â¹âº : âˆ€ {n} â†’ âˆ… â‰± Â¹âº n
-- -- -- --   âˆ…â‰±Â¹âº (â‰¥â»Â¹ âˆ…â‰¥Â²âºn) = âˆ…â‰±Â¹âº âˆ…â‰¥Â²âºn

-- -- -- --   _âˆ™_ : âˆ€ {n m} â†’ n â‰¥ m â†’ âˆ€ {l} â†’ m â‰¥ l â†’ n â‰¥ l
-- -- -- --   â‰¥âˆ… âˆ™ â‰¥âˆ… = â‰¥âˆ…
-- -- -- --   â‰¥âˆ… âˆ™ â‰¥â»Â¹ xâ‚ = âŠ¥-elim ({!âˆ…â‰±Â¹âº !})
-- -- -- --   â‰¥â»Â¹ x âˆ™ â‰¥âˆ… = {!!}
-- -- -- --   _âˆ™_ {n} {m} (â‰¥â»Â¹ x) {l} (â‰¥â»Â¹ xâ‚) = â‰¥â»Â¹ (x âˆ™ Â¹âºâ‰¥ xâ‚)

-- -- -- --   stopâ‰¥ : âˆ€ {n} â†’ n â‰± Â¹âº n
-- -- -- --   stopâ‰¥ {âˆ…} (â‰¥â»Â¹ x) = âˆ…â‰±Â¹âº x
-- -- -- --   stopâ‰¥ {Â¹âº n} (â‰¥â»Â¹ (â‰¥â»Â¹ x)) = {!stopâ‰¥ x!}

-- -- -- --   Â¹âºâ‰¥Â¹âº : âˆ€ {n m} â†’ n â‰¥ m â†’ Â¹âº n â‰¥ Â¹âº m
-- -- -- --   Â¹âºâ‰¥Â¹âº {âˆ…} â‰¥âˆ… = â‰¥â»Â¹ {Â¹âº âˆ…} {!!}
-- -- -- --   Â¹âºâ‰¥Â¹âº {Â¹âº n} â‰¥âˆ… = {!!}
-- -- -- --   Â¹âºâ‰¥Â¹âº (â‰¥â»Â¹ x) = {!!}

-- -- -- --   â»Â¹â‰¥â»Â¹ : âˆ€ {n m} â†’ Â¹âº n â‰¥ Â¹âº m â†’ n â‰¥ m
-- -- -- --   â»Â¹â‰¥â»Â¹ {n} {âˆ…} (â‰¥â»Â¹ x) = {!!}
-- -- -- --   â»Â¹â‰¥â»Â¹ {âˆ…} {Â¹âº m} (â‰¥â»Â¹ x) = âŠ¥-elim (âˆ…â‰±Â¹âº (â»Â¹â‰¥â»Â¹ x))
-- -- -- --   â»Â¹â‰¥â»Â¹ {Â¹âº n} {Â¹âº m} (â‰¥â»Â¹ x) = (â»Â¹â‰¥â»Â¹ x) âˆ™ Â¹âºâ‰¥ {!!}

-- -- -- -- --   1>=1 : Â¹âº âˆ… â‰¥ Â¹âº âˆ…
-- -- -- -- --   1>=1 = Â¹âº {!!}

-- -- -- -- --   {- â‹®â†“ -}
-- -- -- -- --   {- h  ï½› A âˆ£ 7 â‰¥ 4 ï½ = ï½› A 7 4 , A 7 5 , A 7 6 , A 7 7 ï½ -}
-- -- -- -- --   {- g  ï½› A âˆ£ 4 â‰¥ 2 ï½ = ï½› A 4 2 , A 4 3 , A 4 4 ï½ -}
-- -- -- -- --   {- hâˆ˜gï½› A âˆ£ 7 â‰¥ 2 ï½ = ï½› A 7 2 , A 7 3 , A 7 4 , A 7 5 , A 7 6 , A 7 7 ï½ -}
-- -- -- -- --   {- f  ï½› A âˆ£ 2 â‰¥ 0 ï½ = ï½› ï½ -}
-- -- -- -- --   {- gâˆ˜fï½› A âˆ£ 4 â‰¥ 0 ï½ = ï½› A 4 0 , A 4 1 , A 4 2 , A 4 3 , A 4 4 ï½ -}
-- -- -- -- --   data â‹†[_/_â‰¥_] {a} (A : â‹† â†’ â‹† â†’ Set a) (m : â‹†) : â‹† â†’ Set a where
-- -- -- -- --     âˆ… : â‹†[ A / m â‰¥ âˆ… ]
-- -- -- -- --     _âˆ·_ : âˆ€ {n} â†’ A m n â†’ â‹†[ A / m â‰¥ Â¹âº n ] â†’ â‹†[ A / m â‰¥ n ]

-- -- -- -- --   _â‰¥'_ : â‹† â†’ â‹† â†’ Set
-- -- -- -- --   m â‰¥' n = â‹†[ (Î» _ _ â†’ âŠ¤) / m â‰¥ n ]

-- -- -- -- --   data _â‰¤_ : â‹† â†’ â‹† â†’ Set where
-- -- -- -- --     âˆ… : âˆ€ {n} â†’ âˆ… â‰¤ n
-- -- -- -- --     Â¹âº_ : âˆ€ {m n} â†’ m â‰¤ n â†’ Â¹âº m â‰¤ Â¹âº n

-- -- -- -- --   {- âƒ”â‹± -}
-- -- -- -- --   {- ï½› A âˆ£ 4 â‰¤ 7 ï½ = ï½› A 3 6 , A 2 5 , A 1 4 , A 0 3 ï½ -}
-- -- -- -- --   {- ï½› A âˆ£ 2 â‰¤ 4 ï½ = ï½› A 1 3 , A 0 2 ï½ -}
-- -- -- -- --   data â‹†[_/_â‰¤_] {a} (A : â‹† â†’ â‹† â†’ Set a) : â‹† â†’ â‹† â†’ Set a where
-- -- -- -- --     âˆ… : âˆ€ {n} â†’ â‹†[ A / âˆ… â‰¤ n ]
-- -- -- -- --     _âˆ·_ : âˆ€ {m n} â†’ A m n â†’ â‹†[ A / m â‰¤ n ] â†’ â‹†[ A / Â¹âº m â‰¤ Â¹âº n ]

-- -- -- -- -- --   ---- indices on first and second constructors: 1 and 2
-- -- -- -- -- --   data â‹†[_,_] : â‹† â†’ â‹† â†’ Set where
-- -- -- -- -- --     âˆ… : âˆ€ {n} â†’ â‹†[ n , n ]
-- -- -- -- -- --     ! : âˆ€ {m n} â†’ â‹†[ m , n ] â†’ â‹†[ m , ! n ]

-- -- -- -- -- --   data â‹†[_,_] : â‹† â†’ â‹† â†’ Set where
-- -- -- -- -- --     âˆ… : âˆ€ {m n} â†’ â‹†[ m , n ]
-- -- -- -- -- --     ! : âˆ€ {m n} â†’ â‹†[ m , n ] â†’ â‹†[ ! m , ! n ]

-- -- -- -- -- --   -- ?
-- -- -- -- -- --   data _â‰›_ : â‹† â†’ â‹† â†’ Set where
-- -- -- -- -- --     âˆ… : âˆ… â‰› âˆ…
-- -- -- -- -- --     ! : âˆ€ {m} â†’ â‹†[ m , m ] â†’ â‹†[ ! m , ! m ]

-- -- -- -- -- --   data [_/_â†¦_] {a} (A : â‹† â†’ â‹† â†’ Set a) : â‹† â†’ â‹† â†’ Set a where
-- -- -- -- -- --     âˆ… : âˆ€ {n} â†’ [ A / âˆ… â†¦ n ]
-- -- -- -- -- --     ! : âˆ€ {m n} â†’ A m n â†’ [ A / ! m â†¦ ! n ]

-- -- -- -- -- -- module _ where -- Two constructors, where the second constructor adds a payload and a recursive element

-- -- -- -- -- -- -- List
-- -- -- -- -- -- data [_] {a} (A : Set a) : Set a where
-- -- -- -- -- --   âˆ… : [ A ]
-- -- -- -- -- --   _,_ : A â†’ [ A ] â†’ [ A ]

-- -- -- -- -- -- -- Fin
-- -- -- -- -- -- â‹†[_] = â‹†[ âˆ… ,_]

-- -- -- -- -- -- record âŠ¤ : Set where

-- -- -- -- -- -- record âˆƒ {a} {A : Set a} {b} (B : A â†’ Set b) : Set (a âŠ” b) where
-- -- -- -- -- --   field
-- -- -- -- -- --     âŸ± : A
-- -- -- -- -- --     âŸ° : B âŸ±

-- -- -- -- -- -- syntax âˆƒ (Î» x â†’ f) = âˆƒ[ x ] f

-- -- -- -- -- -- _Ã—_ : âˆ€ {a} (A : Set a) {b} (B : Set b) â†’ Set (a âŠ” b)
-- -- -- -- -- -- A Ã— B = âˆƒ {A = A} (Î» _ â†’ B)

-- -- -- -- -- -- --
-- -- -- -- -- -- [_â†¦_] : â‹† â†’ â‹† â†’ Set
-- -- -- -- -- -- [_â†¦_] = [ (Î» m n â†’ â‹†[ ! m ] Ã— {![ m â†¦ n ]!}) /_â†¦_]

-- -- -- -- --   -- open import Agda.Builtin.Equality
-- -- -- -- --   -- open import Data.Empty
