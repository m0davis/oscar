
open import Oscar.Prelude
open import Oscar.Class.Surjection
open import Oscar.Class.Surjectivity
open import Oscar.Class.Reflexivity
open import Oscar.Data.Proposequality

module Oscar.Class.Surjidentity where

module _
  {ğ”¬â‚ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â„“â‚‚}
  {ğ”’â‚ : Ã˜ ğ”¬â‚}
  (_âˆ¼â‚_ : ğ”’â‚ â†’ ğ”’â‚ â†’ Ã˜ ğ”¯â‚)
  {ğ”’â‚‚ : Ã˜ ğ”¬â‚‚}
  (_âˆ¼â‚‚_ : ğ”’â‚‚ â†’ ğ”’â‚‚ â†’ Ã˜ ğ”¯â‚‚)
  (_âˆ¼Ì‡â‚‚_ : âˆ€ {x y} â†’ x âˆ¼â‚‚ y â†’ x âˆ¼â‚‚ y â†’ Ã˜ â„“â‚‚)
  â¦ƒ _ : ğ“¢urjection ğ”’â‚ ğ”’â‚‚ â¦„
  â¦ƒ _ : [ğ“¢urjectivity] _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¢urjectivity _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚‚_ â¦„
  where
  [ğ“ˆurjidentity] = Î» x â†’ surjectivity (Îµ[ _âˆ¼â‚_ ] {x}) âˆ¼Ì‡â‚‚ Îµ

module _
  {ğ”¬â‚} {ğ”’â‚ : Ã˜ ğ”¬â‚} {â„“â‚‚} (ğ”“ : ğ”’â‚ â†’ Ã˜ â„“â‚‚)
  where
  ğ“ˆurjidentity = âˆ€ {x} â†’ ğ”“ x
  module _
    ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚
    where
    record [ğ’®urjidentity] : Ã˜ ğ”¬â‚ âˆ™Ì‚ â†‘Ì‚ (ğ”¯â‚ âˆ™Ì‚ ğ”¬â‚‚ âˆ™Ì‚ ğ”¯â‚‚ âˆ™Ì‚ â„“â‚‚) where
      constructor âˆ
      field
        _âˆ¼â‚_ : ğ”’â‚ â†’ ğ”’â‚ â†’ Ã˜ ğ”¯â‚
        {ğ”’â‚‚} : Ã˜ ğ”¬â‚‚
        _âˆ¼â‚‚_ : ğ”’â‚‚ â†’ ğ”’â‚‚ â†’ Ã˜ ğ”¯â‚‚
        _âˆ¼Ì‡â‚‚_ : âˆ€ {x y} â†’ x âˆ¼â‚‚ y â†’ x âˆ¼â‚‚ y â†’ Ã˜ â„“â‚‚
        â¦ƒ `ğ“¢urjection     â¦„ : ğ“¢urjection ğ”’â‚ ğ”’â‚‚
        â¦ƒ `[ğ“¢urjectivity] â¦„ : [ğ“¢urjectivity] _âˆ¼â‚_ _âˆ¼â‚‚_
        â¦ƒ `ğ“¢urjectivity   â¦„ : ğ“¢urjectivity _âˆ¼â‚_ _âˆ¼â‚‚_
        â¦ƒ `ğ“¡eflexivityâ‚   â¦„ : ğ“¡eflexivity _âˆ¼â‚_
        â¦ƒ `ğ“¡eflexivityâ‚‚   â¦„ : ğ“¡eflexivity _âˆ¼â‚‚_
        â¦ƒ `Proposequality[ğ“ˆurjidentity] â¦„ : [ğ“ˆurjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_ â‰¡ ğ”“

[ğ“¢urjidentity] : âˆ€
  {ğ”¬â‚ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â„“â‚‚}
  {ğ”’â‚ : Ã˜ ğ”¬â‚}
  (_âˆ¼â‚_ : ğ”’â‚ â†’ ğ”’â‚ â†’ Ã˜ ğ”¯â‚)
  {ğ”’â‚‚ : Ã˜ ğ”¬â‚‚}
  (_âˆ¼â‚‚_ : ğ”’â‚‚ â†’ ğ”’â‚‚ â†’ Ã˜ ğ”¯â‚‚)
  (_âˆ¼Ì‡â‚‚_ : âˆ€ {x y} â†’ x âˆ¼â‚‚ y â†’ x âˆ¼â‚‚ y â†’ Ã˜ â„“â‚‚)
  â¦ƒ _ : ğ“¢urjection ğ”’â‚ ğ”’â‚‚ â¦„
  â¦ƒ _ : [ğ“¢urjectivity] _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¢urjectivity _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚‚_ â¦„
  ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚
  â†’ Ã˜ ğ”¬â‚ âˆ™Ì‚ â†‘Ì‚ (ğ”¯â‚ âˆ™Ì‚ ğ”¬â‚‚ âˆ™Ì‚ ğ”¯â‚‚ âˆ™Ì‚ â„“â‚‚)
[ğ“¢urjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_ = [ğ’®urjidentity] ([ğ“ˆurjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_)

module _
  {ğ”¬â‚ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â„“â‚‚}
  {ğ”’â‚ : Ã˜ ğ”¬â‚}
  (_âˆ¼â‚_ : ğ”’â‚ â†’ ğ”’â‚ â†’ Ã˜ ğ”¯â‚)
  {ğ”’â‚‚ : Ã˜ ğ”¬â‚‚}
  (_âˆ¼â‚‚_ : ğ”’â‚‚ â†’ ğ”’â‚‚ â†’ Ã˜ ğ”¯â‚‚)
  (_âˆ¼Ì‡â‚‚_ : âˆ€ {x y} â†’ x âˆ¼â‚‚ y â†’ x âˆ¼â‚‚ y â†’ Ã˜ â„“â‚‚)
  â¦ƒ _ : ğ“¢urjection ğ”’â‚ ğ”’â‚‚ â¦„
  â¦ƒ _ : [ğ“¢urjectivity] _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¢urjectivity _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚‚_ â¦„
  where
  ğ“¼urjidentity = ğ“ˆurjidentity ([ğ“ˆurjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_)

record ğ’®urjidentity
  {ğ”¬â‚} {ğ”’â‚ : Ã˜ ğ”¬â‚} {â„“â‚‚}
    (ğ”“ : ğ”’â‚ â†’ Ã˜ â„“â‚‚)
  {ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚}
    â¦ƒ _ : [ğ’®urjidentity] ğ”“ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â¦„
  : Ã˜ ğ”¬â‚ âˆ™Ì‚ â„“â‚‚ where
  field
    surjidentity : ğ“ˆurjidentity ğ”“
open ğ’®urjidentity â¦ƒ â€¦ â¦„ public

ğ“¢urjidentity : âˆ€
  {ğ”¬â‚ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â„“â‚‚}
  {ğ”’â‚ : Ã˜ ğ”¬â‚}
  (_âˆ¼â‚_ : ğ”’â‚ â†’ ğ”’â‚ â†’ Ã˜ ğ”¯â‚)
  {ğ”’â‚‚ : Ã˜ ğ”¬â‚‚}
  (_âˆ¼â‚‚_ : ğ”’â‚‚ â†’ ğ”’â‚‚ â†’ Ã˜ ğ”¯â‚‚)
  (_âˆ¼Ì‡â‚‚_ : âˆ€ {x y} â†’ x âˆ¼â‚‚ y â†’ x âˆ¼â‚‚ y â†’ Ã˜ â„“â‚‚)
  â¦ƒ _ : ğ“¢urjection ğ”’â‚ ğ”’â‚‚ â¦„
  â¦ƒ _ : [ğ“¢urjectivity] _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¢urjectivity _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : [ğ“¢urjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â¦„
  â†’ Ã˜ ğ”¬â‚ âˆ™Ì‚ â„“â‚‚
ğ“¢urjidentity _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_ = ğ’®urjidentity ([ğ“ˆurjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_)

surjidentity[_,_] : âˆ€
  {ğ”¬â‚ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â„“â‚‚}
  {ğ”’â‚ : Ã˜ ğ”¬â‚}
  (_âˆ¼â‚_ : ğ”’â‚ â†’ ğ”’â‚ â†’ Ã˜ ğ”¯â‚)
  {ğ”’â‚‚ : Ã˜ ğ”¬â‚‚}
  {_âˆ¼â‚‚_ : ğ”’â‚‚ â†’ ğ”’â‚‚ â†’ Ã˜ ğ”¯â‚‚}
  (_âˆ¼Ì‡â‚‚_ : âˆ€ {x y} â†’ x âˆ¼â‚‚ y â†’ x âˆ¼â‚‚ y â†’ Ã˜ â„“â‚‚)
  â¦ƒ _ : ğ“¢urjection ğ”’â‚ ğ”’â‚‚ â¦„
  â¦ƒ _ : [ğ“¢urjectivity] _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¢urjectivity _âˆ¼â‚_ _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚_ â¦„
  â¦ƒ _ : ğ“¡eflexivity _âˆ¼â‚‚_ â¦„
  â¦ƒ _ : [ğ“¢urjidentity] _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_ ğ”¯â‚ ğ”¬â‚‚ ğ”¯â‚‚ â¦„
  â¦ƒ _ : ğ“¢urjidentity _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_ â¦„
  â†’ ğ“¼urjidentity _âˆ¼â‚_ _âˆ¼â‚‚_ _âˆ¼Ì‡â‚‚_
surjidentity[ _ , _ ] = surjidentity
