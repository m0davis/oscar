
module Oscar.Class.Preservativity where

open import Oscar.Level
open import Oscar.Relation

record Preservativity
  {a} {A : Set a} {b} {B : A â†’ Set b} {c} {C : (x : A) â†’ B x â†’ Set c}
    (_â–»â‚_ : (x : A) â†’ (y : B x) â†’ C x y)
  {d} {D : Set d} {e} {E : D â†’ Set e} {f} {F : (x : D) â†’ E x â†’ Set f}
    (_â–»â‚‚_ : (x : D) â†’ (y : E x) â†’ F x y)
  {â„“}
    (_â‰¤_ : âˆ€ {x y} â†’ F x y â†’ F x y â†’ Set â„“)
    (â—½ : A â†’ D)
    (â—» : âˆ€ {x} â†’ B x â†’ E (â—½ x))
    (â–¡ : âˆ€ {x y} â†’ C x y â†’ F (â—½ x) (â—» y))
  : Set (a âŠ” b âŠ” c âŠ” d âŠ” e âŠ” f âŠ” â„“) where
  field
    preservativity : âˆ€ (x : A) (y : B x) â†’ â–¡ (x â–»â‚ y) â‰¤ (â—½ x â–»â‚‚ â—» y)

open Preservativity â¦ƒ â€¦ â¦„ public

-- -- record Preservativity
-- --   {ğ”â‚} {ğ”„â‚ : Set ğ”â‚} {ğ”°â‚} {_â–ºâ‚_ : ğ”„â‚ â†’ ğ”„â‚ â†’ Set ğ”°â‚}
-- --     (_â—…â‚_ : âˆ€ {m n} â†’ m â–ºâ‚ n â†’ âˆ€ {l} â†’ m âŸ¨ l â–ºâ‚_ âŸ©â†’ n)
-- --   {ğ”â‚‚} {ğ”„â‚‚ : Set ğ”â‚‚} {ğ”°â‚‚} (_â–ºâ‚‚_ : ğ”„â‚‚ â†’ ğ”„â‚‚ â†’ Set ğ”°â‚‚)
-- --     (_â—…â‚‚_ : âˆ€ {m n} â†’ m â–ºâ‚‚ n â†’ âˆ€ {l} â†’ m âŸ¨ l â–ºâ‚‚_ âŸ©â†’ n)
-- --   {â„“}
-- --     (_â‰¤_ : âˆ€ {m n} â†’ m â–ºâ‚‚ n â†’ m â–ºâ‚‚ n â†’ Set â„“)
-- --   {Î¼ : ğ”„â‚ â†’ ğ”„â‚‚}
-- --     (â—½ : âˆ€ {m n} â†’ m â–ºâ‚ n â†’ Î¼ m â–ºâ‚‚ Î¼ n)
-- --   : Set (ğ”â‚ âŠ” ğ”°â‚ âŠ” ğ”â‚‚ âŠ” ğ”°â‚‚ âŠ” â„“) where
-- --   field
-- --     preservativity : âˆ€ {l m} (f : l â–ºâ‚ m) {n} (g : m â–ºâ‚ n) â†’ â—½ (g â—…â‚ f) â‰¤ (â—½ g â—…â‚‚ â—½ f)

-- -- open Preservativity â¦ƒ â€¦ â¦„ public

-- -- -- record Preservativity
-- -- --   {ğ”â‚} {ğ”„â‚ : Set ğ”â‚} {ğ”°â‚}
-- -- --     (_â–ºâ‚_ : ğ”„â‚ â†’ ğ”„â‚ â†’ Set ğ”°â‚) {ğ”±â‚}
-- -- --   {â–¸â‚ : ğ”„â‚ â†’ Set ğ”±â‚}
-- -- --     (_â—ƒâ‚_ : âˆ€ {m n} â†’ m â–ºâ‚ n â†’ m âŸ¨ â–¸â‚ âŸ©â†’ n)
-- -- --   {ğ”â‚‚} {ğ”„â‚‚ : Set ğ”â‚‚} {ğ”°â‚‚}
-- -- --     (_â–ºâ‚‚_ : ğ”„â‚‚ â†’ ğ”„â‚‚ â†’ Set ğ”°â‚‚) {ğ”±â‚‚}
-- -- --   {â–¸â‚‚ : ğ”„â‚‚ â†’ Set ğ”±â‚‚}
-- -- --     (_â—ƒâ‚‚_ : âˆ€ {m n} â†’ m â–ºâ‚‚ n â†’ m âŸ¨ â–¸â‚‚ âŸ©â†’ n)
-- -- --   {â„“}
-- -- --     (_â‰¤_ : âˆ€ {n} â†’ â–¸â‚‚ n â†’ â–¸â‚‚ n â†’ Set â„“)
-- -- --   {Î¼ : ğ”„â‚ â†’ ğ”„â‚‚}
-- -- --     (â—½ : âˆ€ {n} â†’ â–¸â‚ n â†’ â–¸â‚‚ (Î¼ n))
-- -- --     (â–¡ : âˆ€ {m n} â†’ m â–ºâ‚ n â†’ Î¼ m â–ºâ‚‚ Î¼ n)
-- -- --   : Set (ğ”â‚ âŠ” ğ”°â‚ âŠ” ğ”±â‚ âŠ” ğ”â‚‚ âŠ” ğ”°â‚‚ âŠ” ğ”±â‚‚ âŠ” â„“) where
-- -- --   field
-- -- --     preservativity : âˆ€ {m n} (f : â–¸â‚ m) (g : m â–ºâ‚ n) â†’ â—½ (g â—ƒâ‚ f) â‰¤ (â–¡ g â—ƒâ‚‚ â—½ f)

-- -- -- open Preservativity â¦ƒ â€¦ â¦„ public

-- -- -- open import Oscar.Class.Associativity
-- -- -- open import Oscar.Class.Symmetry
-- -- -- open import Oscar.Function

-- -- -- instance

-- -- --   Preservativityâ‹† : âˆ€
-- -- --     {ğ”} {ğ”„ : Set ğ”} {ğ”°} {_â–º_ : ğ”„ â†’ ğ”„ â†’ Set ğ”°}
-- -- --       {_â—…_ : âˆ€ {m n} â†’ m â–º n â†’ âˆ€ {l} â†’ m âŸ¨ l â–º_ âŸ©â†’ n}
-- -- --     {ğ”±} {â–¸ : ğ”„ â†’ Set ğ”±}
-- -- --       {_â—ƒ_ : âˆ€ {m n} â†’ m â–º n â†’ m âŸ¨ â–¸ âŸ©â†’ n}
-- -- --     {â„“}
-- -- --       {_â‰¤_ : âˆ€ {n} â†’ â–¸ n â†’ â–¸ n â†’ Set â„“}
-- -- --     â¦ƒ _ : Associativity _â—…_ _â—ƒ_ _â‰¤_ â¦„
-- -- --     â†’ âˆ€ {n} {x : â–¸ n}
-- -- --     â†’ Preservativity _â–º_ (Î» â‹† â†’ _â—…_ â‹†) _â–º_ _â—ƒ_ (flip _â‰¤_) (_â—ƒ x) id
-- -- --   Preservativity.preservativity (Preservativityâ‹† {_â—…_ = _â—…_} {_â—ƒ_ = _â—ƒ_} {_â‰¤_ = _â‰¤_} â¦ƒ â€²associativity â¦„ {x = x}) f = associativity {_â—…_ = _â—…_} {_â—ƒ_ = _â—ƒ_} {_â‰¤_ = _â‰¤_} â¦ƒ {-â€²associativity-}_ â¦„ x f

-- -- -- preservation : âˆ€
-- -- --   {ğ”â‚} {ğ”„â‚ : Set ğ”â‚} {ğ”°â‚} {_â–ºâ‚_ : ğ”„â‚ â†’ ğ”„â‚ â†’ Set ğ”°â‚} {ğ”±â‚} {â–¸â‚ : ğ”„â‚ â†’ Set ğ”±â‚}
-- -- --     (_â—ƒâ‚_ : âˆ€ {m n} â†’ m â–ºâ‚ n â†’ m âŸ¨ â–¸â‚ âŸ©â†’ n)
-- -- --   {ğ”â‚‚} {ğ”„â‚‚ : Set ğ”â‚‚} {ğ”°â‚‚} {_â–ºâ‚‚_ : ğ”„â‚‚ â†’ ğ”„â‚‚ â†’ Set ğ”°â‚‚} {ğ”±â‚‚} {â–¸â‚‚ : ğ”„â‚‚ â†’ Set ğ”±â‚‚}
-- -- --     (_â—ƒâ‚‚_ : âˆ€ {m n} â†’ m â–ºâ‚‚ n â†’ m âŸ¨ â–¸â‚‚ âŸ©â†’ n)
-- -- --   {â„“}
-- -- --     (_â‰¤_ : âˆ€ {n} â†’ â–¸â‚‚ n â†’ â–¸â‚‚ n â†’ Set â„“)
-- -- --   {Î¼ : ğ”„â‚ â†’ ğ”„â‚‚}
-- -- --   {â—½ : âˆ€ {n} â†’ â–¸â‚ n â†’ â–¸â‚‚ (Î¼ n)}
-- -- --   {â–¡ : âˆ€ {m n} â†’ m â–ºâ‚ n â†’ Î¼ m â–ºâ‚‚ Î¼ n}
-- -- --   â¦ƒ _ : Preservativity _â–ºâ‚_ _â—ƒâ‚_ _â–ºâ‚‚_ _â—ƒâ‚‚_ _â‰¤_ â—½ â–¡ â¦„
-- -- --   {m n} (f : â–¸â‚ m) (g : m â–ºâ‚ n) â†’ â—½ (g â—ƒâ‚ f) â‰¤ (â–¡ g â—ƒâ‚‚ â—½ f)
-- -- -- preservation _â—ƒâ‚_ _â—ƒâ‚‚_ _â‰¤_ f g = preservativity {_â—ƒâ‚_ = _â—ƒâ‚_} {_â—ƒâ‚‚_ = _â—ƒâ‚‚_} {_â‰¤_ = _â‰¤_} f g
